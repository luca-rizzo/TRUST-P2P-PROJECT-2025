import{$ as y,B as J,Ba as C,Ca as Q,D as m,I as M,J as u,K as o,L as i,La as X,Ma as Z,Na as S,Oa as k,P as b,Pa as T,Q as p,Qa as V,R as d,Ra as E,Sa as j,T as s,U as q,X as x,Y as w,Z as P,Za as N,_ as A,_a as I,a as W,aa as B,b as D,ba as $,d as L,fa as U,ga as v,ha as Y,ka as G,l as f,m as F,p as R,s as _,t as O,x as c,xa as H,y as l,za as K}from"./chunk-KXASHN7R.js";var z=(()=>{class r extends Q{constructor(){let t={groups:[],errorMessage:""};super(t),this.contractSevice=_(X),this.toastr=_(K),this.loader=_(Z),this.groups$=this.select(n=>n.groups),this.errorMessage$=this.select(n=>n.errorMessage),this.refreshAllGroups=this.effect(n=>n.pipe(F(()=>this.loader.show()),f(()=>this.contractSevice.myGroups$.pipe(C(e=>this.setGroups(e),e=>this.handleError(e)))),F(()=>this.loader.hide()))),this.createGroup=this.effect(n=>n.pipe(f(e=>this.contractSevice.createGroup(e.name,e.addresses).pipe(C(a=>{this.toastr.success("Transaction submitted: waiting for confirmation on the network...")},a=>this.handleError(a)),f(a=>L(a.wait()).pipe(C(g=>{this.refreshAllGroups(),this.toastr.success("New group created successfully!")},g=>this.handleError(g)))))))),this.requestToJoin=this.effect(n=>n.pipe(f(e=>this.contractSevice.requestToJoinGroup(e).pipe(C(a=>{this.toastr.success("Transaction submitted: waiting for confirmation on the network...")},a=>this.handleError(a)),f(a=>L(a.wait()).pipe(C(g=>{this.toastr.success("Request to join group sent successfully!")},g=>this.handleError(g)))))))),this.setGroups=this.updater((n,e)=>D(W({},n),{groups:e}))}handleError(t){console.log(t),this.toastr.error(t.reason??"Internal error: retry later")}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})();function re(r,h){if(r&1){let t=b();o(0,"div",2),p("click",function(){c(t);let e=d();return l(e.showModal=!1)}),o(1,"div",3),p("click",function(e){return c(t),l(e.stopPropagation())}),o(2,"div",4)(3,"h2"),s(4,"Join a TRUST group"),i()(),o(5,"div",5)(6,"form",6,0),p("ngSubmit",function(){c(t);let e=d();return l(e.requestToJoin())}),o(8,"label",7),s(9,"Group ID:"),i(),o(10,"input",8),P("ngModelChange",function(e){c(t);let a=d();return w(a.groupId,e)||(a.groupId=e),l(e)}),i()()(),o(11,"div",9)(12,"button",10),p("click",function(){c(t);let e=d();return l(e.showModal=!1)}),s(13,"Cancel"),i(),o(14,"button",11),p("click",function(){c(t);let e=d();return l(e.requestToJoin())}),s(15," Request to Join "),i()()()()}if(r&2){let t=d();m(10),x("ngModel",t.groupId),m(4),u("disabled",!t.groupId)}}var te=(()=>{class r{constructor(){this.showModal=!1,this.closed=new J,this.joinGroupSubmitted=new J}requestToJoin(){this.groupId&&(this.joinGroupSubmitted.emit(BigInt(this.groupId||0)),this.reset())}close(){this.closed.emit(),this.reset()}reset(){this.groupId=void 0}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=O({type:r,selectors:[["app-join-group"]],inputs:{showModal:"showModal"},outputs:{closed:"closed",joinGroupSubmitted:"joinGroupSubmitted"},standalone:!0,features:[y],decls:1,vars:1,consts:[["joinForm","ngForm"],["class","modal-backdrop",3,"click",4,"ngIf"],[1,"modal-backdrop",3,"click"],[1,"modal",3,"click"],[1,"modal-header"],[1,"modal-body"],[1,"form-content",3,"ngSubmit"],["for","groupId"],["id","groupId","type","text","name","groupId","placeholder","Enter group ID","required","",3,"ngModelChange","ngModel"],[1,"modal-footer","modal-actions"],["type","button",1,"cancel",3,"click"],["type","submit","form","joinForm",1,"submit",3,"click","disabled"]],template:function(n,e){n&1&&M(0,re,16,2,"div",1),n&2&&u("ngIf",e.showModal)},dependencies:[I,j,S,k,T,N,E,V,G,v],styles:[".modal[_ngcontent-%COMP%]{height:auto;width:500px}"]})}}return r})();function ie(r,h){if(r&1&&(o(0,"li")(1,"span",17),s(2,"\u2022"),i(),o(3,"span",18),s(4),i()()),r&2){let t=h.$implicit;m(4),q(t)}}function ae(r,h){if(r&1){let t=b();o(0,"div",10)(1,"div",11)(2,"h2",12),s(3),i(),o(4,"p",13),s(5,"Members:"),i(),o(6,"ul",14),M(7,ie,5,1,"li",15),i()(),o(8,"button",16),p("click",function(){let e=c(t).$implicit,a=d();return l(a.navigateToGroupPage(e.id))}),s(9,"Show details"),i()()}if(r&2){let t=h.$implicit;m(3),q(t.name),m(4),u("ngForOf",t.members)}}function se(r,h){if(r&1){let t=b();o(0,"div",19),p("click",function(){c(t);let e=d();return l(e.showModal=!1)}),o(1,"div",20),p("click",function(e){return c(t),l(e.stopPropagation())}),o(2,"div",21)(3,"h2"),s(4,"Create new TRUST group"),i()(),o(5,"div",22)(6,"form",23,0),p("ngSubmit",function(){c(t);let e=d();return l(e.createGroup())}),o(8,"label",24),s(9,"Name:"),i(),o(10,"input",25),P("ngModelChange",function(e){c(t);let a=d();return w(a.newGroupName,e)||(a.newGroupName=e),l(e)}),i(),o(11,"label",26),s(12,"Members (1 per row):"),i(),o(13,"textarea",27),P("ngModelChange",function(e){c(t);let a=d();return w(a.newGroupMembers,e)||(a.newGroupMembers=e),l(e)}),i()()(),o(14,"div",28)(15,"button",29),p("click",function(){c(t);let e=d();return l(e.showModal=!1)}),s(16,"Cancel"),i(),o(17,"button",30),p("click",function(){c(t);let e=d();return l(e.createGroup())}),s(18," Create "),i()()()()}if(r&2){let t=d();m(10),x("ngModel",t.newGroupName),m(3),x("ngModel",t.newGroupMembers),m(4),u("disabled",!t.newGroupName||!t.newGroupMembers)}}var Ee=(()=>{class r{constructor(){this.showModal=!1,this.joinGroupModal=!1,this.newGroupName="",this.newGroupMembers="",this.store=_(z),this.router=_(H),this.groups$=this.store.groups$,this.store.refreshAllGroups()}createGroup(){let t=this.newGroupMembers.split(`
`).map(n=>n.trim()).filter(n=>n);this.store.createGroup({name:this.newGroupName,addresses:t}),this.showModal=!1,this.resetModal()}navigateToGroupPage(t){this.router.navigate(["groups",t.toString()])}resetModal(){this.showModal=!1,this.newGroupName="",this.newGroupMembers=""}joinGroup(t){this.store.requestToJoin(t),this.joinGroupModal=!1}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=O({type:r,selectors:[["app-my-groups-list"]],standalone:!0,features:[A([z]),y],decls:13,vars:5,consts:[["form","ngForm"],[1,"group-list"],[1,"header"],[1,"title"],[2,"display","flex","justify-content","end","gap","10px"],[1,"generic-button",3,"click"],[1,"add-button",3,"click"],["class","group-card",4,"ngFor","ngForOf"],["class","modal-backdrop",3,"click",4,"ngIf"],[3,"closed","joinGroupSubmitted","showModal"],[1,"group-card"],[1,"group-details"],[1,"group-title"],[1,"group-subtitle"],[1,"participants"],[4,"ngFor","ngForOf"],[1,"enter-button",3,"click"],[1,"avatar-dot"],[1,"address"],[1,"modal-backdrop",3,"click"],[1,"modal",3,"click"],[1,"modal-header"],[1,"modal-body"],[1,"form-content",3,"ngSubmit"],["for","groupName"],["id","groupName","type","text","name","groupName","placeholder","Nome del gruppo","required","",3,"ngModelChange","ngModel"],["for","groupMembers"],["id","groupMembers","name","groupMembers","rows","5","placeholder","0x123...\\n0x456...","required","",2,"width","100%","resize","none","height","100%",3,"ngModelChange","ngModel"],[1,"modal-footer","modal-actions"],["type","button",1,"cancel",3,"click"],["type","submit","form","form",1,"submit",3,"click","disabled"]],template:function(n,e){n&1&&(o(0,"section",1)(1,"div",2)(2,"h1",3),s(3,"My groups"),i(),o(4,"div",4)(5,"button",5),p("click",function(){return e.joinGroupModal=!0}),s(6,"Join group"),i(),o(7,"button",6),p("click",function(){return e.showModal=!0}),s(8,"+"),i()()(),M(9,ae,10,2,"div",7),B(10,"async"),M(11,se,19,3,"div",8),i(),o(12,"app-join-group",9),p("closed",function(){return e.joinGroupModal=!1})("joinGroupSubmitted",function(g){return e.joinGroup(g)}),i()),n&2&&(m(9),u("ngForOf",$(10,3,e.groups$)),m(2),u("ngIf",e.showModal),m(),u("showModal",e.joinGroupModal))},dependencies:[G,U,v,Y,I,j,S,k,T,N,E,V,te],styles:[".group-list[_ngcontent-%COMP%]{max-width:768px;margin:2rem auto;padding:0 1rem}.group-list[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:600;text-align:center}.group-list[_ngcontent-%COMP%]   .group-card[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;background:#fff;padding:1.5rem;border-radius:1rem;box-shadow:0 4px 12px #0000000f;margin-bottom:1.5rem;gap:2rem;transition:transform .2s ease}.group-list[_ngcontent-%COMP%]   .group-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.group-list[_ngcontent-%COMP%]   .group-card[_ngcontent-%COMP%]   .group-content[_ngcontent-%COMP%]{margin-left:20px}.group-list[_ngcontent-%COMP%]   .group-card[_ngcontent-%COMP%]   .group-details[_ngcontent-%COMP%]{flex:1}.group-list[_ngcontent-%COMP%]   .group-card[_ngcontent-%COMP%]   .group-details[_ngcontent-%COMP%]   .group-title[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:600;margin-bottom:.5rem}.group-list[_ngcontent-%COMP%]   .group-card[_ngcontent-%COMP%]   .group-details[_ngcontent-%COMP%]   .group-subtitle[_ngcontent-%COMP%]{font-weight:500;color:#4b5563;margin-bottom:.25rem}.group-list[_ngcontent-%COMP%]   .group-card[_ngcontent-%COMP%]   .group-details[_ngcontent-%COMP%]   .participants[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0 0 0 10px}.group-list[_ngcontent-%COMP%]   .group-card[_ngcontent-%COMP%]   .group-details[_ngcontent-%COMP%]   .participants[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;align-items:center;font-family:monospace;font-size:.9rem;margin-bottom:.25rem}.group-list[_ngcontent-%COMP%]   .group-card[_ngcontent-%COMP%]   .group-details[_ngcontent-%COMP%]   .participants[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .avatar-dot[_ngcontent-%COMP%]{color:#2fa4a0;font-size:1.1rem;margin-right:.5rem}.group-list[_ngcontent-%COMP%]   .group-card[_ngcontent-%COMP%]   .group-details[_ngcontent-%COMP%]   .participants[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{word-break:break-all;color:#374151}.group-list[_ngcontent-%COMP%]   .group-card[_ngcontent-%COMP%]   .enter-button[_ngcontent-%COMP%]{background-color:#2fa4a0;color:#fff;font-weight:500;padding:.6rem 1.2rem;border:none;border-radius:.8rem;cursor:pointer;align-self:center;transition:background .2s}.group-list[_ngcontent-%COMP%]   .group-card[_ngcontent-%COMP%]   .enter-button[_ngcontent-%COMP%]:hover{background-color:#278c89}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.header[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]{background-color:orange;color:#fff;font-size:1.5rem;width:2.5rem;height:2.5rem;border:none;border-radius:50%;cursor:pointer}.header[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover{background-color:#ba7900}.modal-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:9999}.modal[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;width:90%;max-width:600px;height:auto;max-height:80vh;display:flex;flex-direction:column;overflow:hidden;box-shadow:0 10px 25px #00000026}.modal-header[_ngcontent-%COMP%]{padding:1.5rem;border-bottom:1px solid #e5e7eb;background-color:#f9fafb;flex-shrink:0}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.4rem}.modal-body[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding-left:2rem;padding-bottom:2rem;padding-right:2rem}.modal-body[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-top:1rem;margin-bottom:.4rem;font-weight:500}.modal-body[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .modal-body[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], .modal-body[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .modal-body[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.6rem;border-radius:.5rem;border:1px solid #ccc;font-size:1rem}.modal-body[_ngcontent-%COMP%]   .participants[_ngcontent-%COMP%]{margin-top:1rem;display:flex;flex-direction:column;gap:1rem}.modal-body[_ngcontent-%COMP%]   .participants[_ngcontent-%COMP%]   .participant-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.modal-body[_ngcontent-%COMP%]   .participants[_ngcontent-%COMP%]   .participant-row[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{font-family:monospace;font-size:.9rem;word-break:break-all}.modal-body[_ngcontent-%COMP%]   .participants[_ngcontent-%COMP%]   .split-input[_ngcontent-%COMP%]{width:100%;margin-top:.5rem;padding:.4rem .6rem;border-radius:.5rem;border:1px solid #ccc;font-size:.95rem}.modal-body[_ngcontent-%COMP%]   .participants[_ngcontent-%COMP%]   .split-separator[_ngcontent-%COMP%]{margin-top:.5rem;border:none;border-top:1px dashed #e5e7eb}.modal-footer[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-top:1px solid #e5e7eb;background-color:#f9fafb;flex-shrink:0;display:flex;justify-content:flex-end;gap:1rem}.modal-footer[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%], .modal-footer[_ngcontent-%COMP%]   .submit[_ngcontent-%COMP%]{padding:.6rem 1.2rem;border-radius:.5rem;border:none;cursor:pointer;font-weight:500;font-size:.95rem}.modal-footer[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{background-color:#e5e7eb;color:#1f2937}.modal-footer[_ngcontent-%COMP%]   .submit[_ngcontent-%COMP%]{background-color:#10b981;color:#fff}.modal-footer[_ngcontent-%COMP%]   .submit[_ngcontent-%COMP%]:disabled{background-color:#a7f3d0;cursor:not-allowed}"]})}}return r})();export{Ee as MyGroupsListComponent};
